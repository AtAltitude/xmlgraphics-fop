<?xml version="1.0"?>
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">
  <!-- =========================== Components ================================ -->
  <map:components>
    <map:serializers default="html">
      <!-- ========================== FOP Additions ========================== -->
      <map:serializer name="svg2pdf" mime-type="application/pdf" src="org.apache.cocoon.serialization.SVGSerializer">
        <parameter name="transcoder" value="org.apache.fop.svg.PDFTranscoder"/>
      </map:serializer>
      <!-- ======================= End FOP Additions ======================== -->
    </map:serializers>
  </map:components>
  <!-- =========================== Views =================================== -->
  <map:views>
    <map:view name="content" from-label="content">
      <map:serialize type="xml"/>
    </map:view>
    <map:view name="pretty-content" from-label="content">
      <map:transform src="library/xslt/simple-xml2html.xsl"/>
      <map:serialize type="html"/>
    </map:view>
    <map:view name="links" from-position="last">
      <map:transform src="library/xslt/filterlinks.xsl"/>
      <map:serialize type="links"/>
    </map:view>
  </map:views>
  <!-- =========================== Pipelines ================================= -->
  <map:pipelines>
    <!-- Utility Pipeline that creates the grammer for the Chaperon Wiki -->
    <!-- Pipeline that manages the internal URI space
       For the external URI space manager, see the next pipeline.
       Set it to internal-only="true" in production environment -->
    <!--
    <map:pipeline internal-only="false">
    -->
      <!-- ========================== FOP Additions ========================== -->
    <!--
      <map:match pattern="**compliance.xml">
        <map:generate src="{project:content.xdocs}{1}compliance.xml"/>
          <map:transform src="{project:resources.stylesheets}/compliance2document.xsl"/>
        <map:serialize type="xml"/>
      </map:match>
      <!-- ======================== End FOP Additions ======================== -->
    </map:pipeline>
    -->
    <map:pipeline internal-only="false">
      <!-- ========================== FOP Additions ========================== -->
      <map:match pattern="*/svg/*.svg">
        <map:read src="content/xdocs/{1}/svg/{2}.svg" mime-type="image/svg"/>
      </map:match>
      <map:match pattern="*/svg/*.pdf">
        <map:generate src="content/xdocs/{1}/svg/{2}.svg"/>
        <map:serialize type="svg2pdf"/>
      </map:match>
      <map:match pattern="fo/*.fo">
        <map:read src="content/xdocs/fo/{1}.fo" mime-type="text/xml"/>
      </map:match>
      <map:match pattern="fo/*.ent">
        <map:read src="content/xdocs/fo/{1}.ent" mime-type="text/plain"/>
      </map:match>
      <map:match pattern="fo/*.fo.pdf">
        <map:generate src="content/fo/{1}.fo"/>
        <map:serialize type="fo2pdf"/>
      </map:match>
      <map:match pattern="**/fo/*.fo">
        <map:read src="content/{1}/fo/{2}.fo" mime-type="text/xml"/>
      </map:match>
      <map:match pattern="**/fo/*.fo.pdf">
        <map:generate src="content/{1}/fo/{2}.fo"/>
        <map:serialize type="fo2pdf"/>
      </map:match>
      <!--
      <map:match pattern="compliance.pdf">
        <map:generate src="content/xdocs/compliance.xml"/>
        <map:transform src="resources/stylesheets/compliance2fo.xsl" label="content"/>
        <map:serialize type="fo2pdf"/>
      </map:match>
      -->
      <!-- ======================= End FOP Additions ======================== -->
    </map:pipeline>
  </map:pipelines>
</map:sitemap>
